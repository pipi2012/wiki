<!DOCTYPE HTML>
<html>
    <head>
        <link rel="Stylesheet" type="text/css" href="/static/css/style.css">
        <link rel="Stylesheet" type="text/css" href="/static/css/tango.css">
        <link rel="Stylesheet" type="text/css" href="/static/css/typo.css">
        <link rel="Stylesheet" type="text/css" href="/static/css/reset_typo.css">
    	<link rel="icon" href="http://7xjtfr.com1.z0.glb.clouddn.com/favicon.ico">
        <title>git-命令 - Wiki | StarsCount</title>
        <meta name="keywords" content="wiki,starscount,simiki"/>
        <meta name="description" content="the Personal Wiki of StarsCount by Programs"/>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    </head>

    <body>
        <div id="container" class="typo">
            
    <div id="header">
        <div id="post-nav">
            
            <a href="/">Home</a> » <a href="/#Tool">Tool</a> » git-命令
            
        </div>
    </div>
    <div class="clearfix"></div>
    <div id="title">git-命令</div>
    <div id="content">
        <h2 id="_1">配置与初始化</h2>
<h3 id="usernameuseremail">配置全局username，useremail</h3>
<div class="hlcode"><pre><span class="err">$</span> <span class="n">git</span> <span class="n">config</span> <span class="o">--</span><span class="n">global</span> <span class="n">user</span><span class="p">.</span><span class="n">name</span> <span class="s">&quot;pipi2012&quot;</span>
<span class="err">$</span> <span class="n">git</span> <span class="n">config</span> <span class="o">--</span><span class="n">global</span> <span class="n">user</span><span class="p">.</span><span class="n">email</span> <span class="s">&quot;pengxing0829@163.com&quot;</span>
</pre></div>


<h3 id="git-bash">git bash设置代理</h3>
<div class="hlcode"><pre><span class="err">查看已有配置</span>
<span class="err">$</span> <span class="n">git</span> <span class="n">config</span> <span class="o">--</span><span class="n">list</span>
<span class="err">设置代理</span>
<span class="err">$</span> <span class="n">git</span> <span class="n">config</span> <span class="o">--</span><span class="n">global</span> <span class="n">http</span><span class="p">.</span><span class="n">proxy</span> <span class="n">http</span><span class="o">:</span><span class="c1">//proxyname:port</span>
<span class="err">删除代理设置</span>
<span class="err">$</span> <span class="n">git</span> <span class="n">config</span> <span class="o">--</span><span class="n">global</span> <span class="o">--</span><span class="n">unset</span> <span class="n">http</span><span class="p">.</span><span class="n">proxy</span>
</pre></div>


<h3 id="_2">创建版本库（初始化仓库）</h3>
<div class="hlcode"><pre><span class="err">$</span> <span class="n">cd</span> <span class="n">gitdir</span>
<span class="err">$</span> <span class="n">git</span> <span class="n">init</span>
</pre></div>


<h2 id="git">git分区</h2>
<h3 id="_3">三大分区</h3>
<div class="hlcode"><pre><span class="n">working</span> <span class="n">tree</span><span class="o">--</span><span class="err">工作区</span>  
<span class="n">stage</span> <span class="n">index</span><span class="o">--</span><span class="err">索引文件（暂存区）</span>  
<span class="n">HEAD</span><span class="err">（</span><span class="n">local</span><span class="o">/</span><span class="n">remote</span> <span class="n">repository</span><span class="p">)</span><span class="err">）</span><span class="o">--</span><span class="err">数据仓库</span>
</pre></div>


<h3 id="stage">增加Stage好处</h3>
<div class="hlcode"><pre><span class="mi">1</span><span class="err">）分批、分阶段递交</span>
<span class="mi">2</span><span class="err">）进行快照，便于回退</span>
<span class="mi">3</span><span class="err">）提高工作区文件改动状态比较速度。</span>
</pre></div>


<h3 id="_4">不同区文件差别比较</h3>
<div class="hlcode"><pre><span class="n">git</span> <span class="n">diff</span>    <span class="c1">//working tree与stage index差别</span>
<span class="n">git</span> <span class="n">diff</span> <span class="o">--</span><span class="n">cached</span>   <span class="c1">//查看stage index与commit差别</span>
<span class="n">git</span> <span class="n">diff</span> <span class="n">HEAD</span>  <span class="c1">//查看working tree和commit差别</span>
</pre></div>


<h2 id="_5">查看日志</h2>
<h3 id="_6">查看提交历史日志</h3>
<div class="hlcode"><pre><span class="err">$</span> <span class="n">git</span> <span class="n">log</span> 
<span class="err">$</span> <span class="n">git</span> <span class="n">log</span> <span class="o">--</span><span class="n">oneline</span> <span class="c1">//单行精简显示</span>
</pre></div>


<h3 id="_7">查看命令历史日志</h3>
<div class="hlcode"><pre><span class="n">git</span> <span class="n">reflog</span> <span class="c1">//查看操作命令历史，版本回退的话，可以用其查看要回退到的版本</span>
</pre></div>


<h2 id="_8">本地仓库操作</h2>
<h3 id="_9">工作树和索引的状态查看</h3>
<div class="hlcode"><pre><span class="n">git</span> <span class="n">status</span>
</pre></div>


<h3 id="indexstage">工作区文件添加索引区index（暂存区stage）</h3>
<div class="hlcode"><pre><span class="err">$</span> <span class="nx">git</span> <span class="nb">add</span> <span class="o">&lt;</span><span class="nb">file</span><span class="o">&gt;</span>
<span class="nx">git</span> <span class="nb">add</span> <span class="na">-A</span>   <span class="nx">stages</span> <span class="kc">All</span> <span class="c1">//添加所有改动的已跟踪文件和未跟踪文件</span>
<span class="nx">git</span> <span class="nb">add</span> <span class="nx">.</span>    <span class="nx">stages</span> <span class="nb">new</span> <span class="ow">and</span> <span class="nx">modified</span><span class="p">,</span> <span class="nx">without</span> <span class="nx">deleted</span>
<span class="nx">git</span> <span class="nb">add</span> <span class="na">-u</span>   <span class="nx">stages</span> <span class="nx">modified</span> <span class="ow">and</span> <span class="nx">deleted</span><span class="p">,</span> <span class="nx">without</span> <span class="nb">new</span> <span class="c1">//只添加已提交过的文件到索引</span>
</pre></div>


<h3 id="indexstagecommit">索引区index（暂存区stage）文件commit到仓库</h3>
<div class="hlcode"><pre><span class="err">$</span> <span class="n">git</span> <span class="n">commit</span> <span class="o">-</span><span class="n">m</span> <span class="s">&quot;commit log message&quot;</span>
</pre></div>


<h3 id="_10">版本回退</h3>
<div class="hlcode"><pre><span class="nx">git</span> <span class="nb">reset</span> <span class="err">[</span><span class="o">--</span><span class="nx">hard</span><span class="o">|</span><span class="nx">soft</span><span class="o">|</span><span class="nx">mixed</span><span class="o">|</span><span class="nb">merge</span><span class="o">|</span><span class="nx">keep</span><span class="cp">]</span> <span class="cp">[</span><span class="o">&lt;</span><span class="nx">commit</span><span class="o">&gt;</span><span class="err">或</span><span class="nb">HEAD</span><span class="cp">]</span>

模式名称    HEAD的位置  索引  工作树
soft        修改      不修改  不修改
mixed       修改      修改   不修改
hard        修改      修改   修改
主要使用的场合：
复原修改过的索引的状态(mixed)
彻底取消最近的提交(hard)
只取消提交(soft)

$ git reset -- file
$ git reset HEAD -- <span class="nt">&lt;file&gt;</span>//将file从stage撤出/删除，此时工作区的文件不做任何修改
</pre></div>


<h3 id="head">重置head版本/版本回退</h3>
<div class="hlcode"><pre><span class="err">$</span> <span class="n">git</span> <span class="n">reset</span> <span class="o">--</span><span class="n">hard</span> <span class="err">版本号</span>
</pre></div>


<h3 id="_11">单步版本回退</h3>
<div class="hlcode"><pre><span class="err">$</span> <span class="n">git</span> <span class="n">reset</span> <span class="o">--</span><span class="n">hard</span> <span class="n">HEAD</span><span class="o">^</span>  <span class="c1">//一步回退</span>
<span class="err">$</span> <span class="n">git</span> <span class="n">reset</span> <span class="o">--</span><span class="n">hard</span> <span class="n">HEAD</span><span class="o">^^</span>  <span class="c1">//两步回退</span>
<span class="err">$</span> <span class="n">git</span> <span class="n">reset</span> <span class="o">--</span><span class="n">hard</span> <span class="n">HEAD</span><span class="o">^^^</span>  <span class="c1">//三步回退</span>
<span class="err">$</span> <span class="n">git</span> <span class="n">reset</span> <span class="o">--</span><span class="n">hard</span> <span class="n">HEAD</span><span class="o">~</span><span class="mi">100</span>  <span class="c1">//一百步回退</span>
</pre></div>


<h3 id="_12">工作区修改文件撤销</h3>
<div class="hlcode"><pre><span class="nx">git</span> <span class="nx">checkout</span> <span class="o">--</span> <span class="o">&lt;</span><span class="nb">file</span><span class="o">&gt;</span>  <span class="c1">//工作区检出文件</span>
<span class="mi">1</span><span class="err">）</span><span class="nb">file</span><span class="err">自动修改后，还没有放到暂存区，使用撤销修改就回到和版本库一模一样的状态。</span>
<span class="mi">2</span><span class="err">）</span><span class="nb">file</span><span class="err">修改后已经放入暂存区了，接着又作了修改，撤销修改就回到添加暂存区后的状态。</span>
</pre></div>


<h3 id="_13">撤销重置</h3>
<div class="hlcode"><pre><span class="nx">git</span> <span class="nb">reset</span> <span class="o">--</span><span class="nx">hard</span> <span class="nb">HEAD</span> <span class="o">&lt;</span><span class="nb">file</span><span class="o">&gt;</span>  <span class="c1">//仅commit区回退</span>
<span class="nx">git</span> <span class="nb">reset</span> <span class="nb">HEAD</span> <span class="o">&lt;</span><span class="nb">file</span><span class="o">&gt;</span>  <span class="c1">//仅commit区和暂存区回退，暂存区未提交文件清空，暂存区撤销到和已提交HEAD版本相同</span>
<span class="err">等价于</span>  <span class="nx">git</span> <span class="nb">reset</span> <span class="o">--</span><span class="nx">mixed</span> <span class="nb">HEAD</span> <span class="o">&lt;</span><span class="nb">file</span><span class="o">&gt;</span>
<span class="nx">git</span> <span class="nb">reset</span> <span class="o">--</span><span class="nx">hard</span> <span class="nb">HEAD</span> <span class="o">&lt;</span><span class="nb">file</span><span class="o">&gt;</span>  <span class="c1">//工作区和暂存区 均会重置到已提交的HEAD版本</span>
</pre></div>


<h3 id="_14">文件检出</h3>
<div class="hlcode"><pre><span class="nx">git</span> <span class="nx">checkout</span> <span class="err">[</span><span class="na">-q</span><span class="cp">]</span> <span class="cp">[</span><span class="o">&lt;</span><span class="nx">commit</span><span class="o">&gt;</span><span class="cp">]</span> <span class="cp">[</span><span class="o">--</span><span class="cp">]</span> <span class="nt">&lt;paths&gt;</span> ..    
<span class="nt">&lt;commit&gt;</span>是可选项，如果省略，则相当于从暂存区进行检出
$ git checkout -- <span class="nt">&lt;file&gt;</span>
将暂存区中的file检出，覆盖工作区中的file文件
$ git checkout HEAD -- <span class="nt">&lt;file&gt;</span> 
将commit中的file检出，覆盖暂存区和工作区中的file文件
</pre></div>


<h3 id="_15">版本回退</h3>
<div class="hlcode"><pre><span class="mi">1</span><span class="err">）如果知道要删掉那些内容的话，直接手动更改去掉那些需要的文件，然后</span><span class="n">add</span><span class="err">添加到暂存区，最后</span><span class="n">commit</span><span class="err">掉。</span>
<span class="mi">2</span><span class="err">）可以按以前的方法直接恢复到上一个版本。使用</span> <span class="n">git</span> <span class="n">reset</span>  <span class="o">--</span><span class="n">hard</span> <span class="n">HEAD</span><span class="o">^</span>
</pre></div>


<h2 id="_16">远程仓库操作</h2>
<h3 id="_17">添加关联远程仓库</h3>
<h4 id="1">1）先有本地仓库，再有远程仓库</h4>
<div class="hlcode"><pre><span class="n">git</span> <span class="n">remote</span> <span class="n">add</span> <span class="n">origin</span> <span class="n">https</span><span class="o">:</span><span class="c1">//github.com/username/repos.git</span>
<span class="n">git</span> <span class="n">push</span> <span class="o">-</span><span class="n">u</span> <span class="n">origin</span> <span class="n">master</span> <span class="c1">//把本地库的内容推送到远程 -u参数：会把本地的master分支和远程的master分支关联起来，在以后的推送或者拉取时就可以简化命令</span>
<span class="n">git</span> <span class="n">push</span> <span class="n">origin</span> <span class="n">master</span> <span class="c1">//把本地库的内容推送到远程，关联之后操作</span>
</pre></div>


<h4 id="2">2）先有远程仓库，再有本地仓库</h4>
<div class="hlcode"><pre><span class="err">建立远程仓库</span>
<span class="n">git</span> <span class="n">clone</span> <span class="n">https</span><span class="o">:</span><span class="c1">//github.com/username/repos.git  //克隆远程仓库到本地仓库</span>
</pre></div>


<h3 id="_18">查看远程库信息</h3>
<div class="hlcode"><pre><span class="n">git</span> <span class="n">remote</span> <span class="c1">//查看远程库的信息</span>
<span class="n">git</span> <span class="n">remote</span> <span class="err">–</span><span class="n">v</span> <span class="c1">//查看远程库的详细信息</span>
</pre></div>


<h3 id="_19">推送分支</h3>
<div class="hlcode"><pre><span class="err">$</span> <span class="n">git</span> <span class="n">push</span> <span class="o">&lt;</span><span class="err">远程主机名</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="err">本地分支名</span><span class="o">&gt;:&lt;</span><span class="err">远程分支名</span><span class="o">&gt;</span>

<span class="err">省略远程分支名，则表示将本地分支推送与之存在”追踪关系”的远程分支</span><span class="p">(</span><span class="err">通常两者同名</span><span class="p">)</span><span class="err">，如果该远程分支不存在，则会被新建</span>
<span class="err">$</span> <span class="n">git</span> <span class="n">push</span> <span class="o">&lt;</span><span class="err">远程主机名</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="err">本地分支名</span><span class="o">&gt;</span>
<span class="err">$</span> <span class="n">git</span> <span class="n">push</span> <span class="n">origin</span> <span class="n">master</span>

<span class="err">省略本地分支名，则表示删除指定的远程分支，等同于推送一个空的本地分支到远程分支。</span>
<span class="err">$</span> <span class="n">git</span> <span class="n">push</span> <span class="o">&lt;</span><span class="err">远程主机名</span><span class="o">&gt;</span> <span class="o">:&lt;</span><span class="err">远程分支名</span><span class="o">&gt;</span>
<span class="err">$</span> <span class="n">git</span> <span class="n">push</span> <span class="n">origin</span> <span class="o">:</span><span class="n">master</span>
<span class="err">等同于</span>
<span class="err">$</span> <span class="n">git</span> <span class="n">push</span> <span class="n">origin</span> <span class="o">--</span><span class="n">delete</span> <span class="n">master</span>

<span class="err">如果当前分支与远程分支之间存在追踪关系，则本地分支和远程分支都可以省略。</span>
<span class="err">$</span> <span class="n">git</span> <span class="n">push</span> <span class="n">origin</span>
<span class="err">如果当前分支只有一个追踪分支，那么主机名都可以省略。</span>
<span class="err">$</span> <span class="n">git</span> <span class="n">push</span>
</pre></div>


<h3 id="_20">推送策略</h3>
<div class="hlcode"><pre><span class="n">master</span><span class="err">分支是主分支，因此要时刻与远程同步。</span>
<span class="err">一些修复</span><span class="n">bug</span><span class="err">分支不需要推送到远程去，可以先合并到主分支上，然后把主分支</span><span class="n">master</span><span class="err">推送到远程去。</span>
</pre></div>


<h3 id="_21">拉取分支</h3>
<div class="hlcode"><pre><span class="n">git</span> <span class="n">pull</span><span class="err">命令的作用是，取回远程主机某个分支的更新，再与本地的指定分支合并</span>
<span class="err">$</span> <span class="n">git</span> <span class="n">pull</span> <span class="o">&lt;</span><span class="err">远程主机名</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="err">远程分支名</span><span class="o">&gt;:&lt;</span><span class="err">本地分支名</span><span class="o">&gt;</span>

<span class="err">$</span> <span class="n">git</span> <span class="n">pull</span> <span class="n">origin</span> <span class="n">next</span><span class="o">:</span><span class="n">master</span>  <span class="c1">//取回origin主机的next分支，与本地的master分支合并</span>
<span class="err">$</span> <span class="n">git</span> <span class="n">pull</span> <span class="n">origin</span> <span class="n">next</span>   <span class="c1">//远程分支是与当前分支合并，则冒号后面的部分可以省略</span>
</pre></div>


<h3 id="_22">手动建立追踪关系</h3>
<div class="hlcode"><pre><span class="err">$</span> <span class="n">git</span> <span class="n">branch</span> <span class="o">--</span><span class="n">set</span><span class="o">-</span><span class="n">upstream</span> <span class="n">master</span> <span class="n">origin</span><span class="o">/</span><span class="n">next</span>   <span class="c1">//指定master分支追踪origin/next分支</span>

<span class="err">$</span> <span class="n">git</span> <span class="n">pull</span> <span class="n">origin</span>  <span class="c1">//如果当前分支与远程分支存在追踪关系，git pull就可以省略远程分支名</span>
</pre></div>


<h2 id="_23">分支操作</h2>
<h3 id="_24">分支命令</h3>
<div class="hlcode"><pre><span class="err">查看分支</span>
<span class="err">$</span> <span class="nx">git</span> <span class="nx">branch</span>
<span class="err">创建分支</span>
<span class="err">$</span> <span class="nx">git</span> <span class="nx">branch</span> <span class="o">&lt;</span><span class="nx">branch</span><span class="o">&gt;</span>
<span class="err">切换分支</span>
<span class="err">$</span> <span class="nx">git</span> <span class="nx">checkout</span> <span class="o">&lt;</span><span class="nx">branch</span><span class="o">&gt;</span>
<span class="err">创建并切换分支</span>
<span class="err">$</span> <span class="nx">git</span> <span class="nx">checkout</span> <span class="na">-b</span> <span class="o">&lt;</span><span class="nx">branch</span><span class="o">&gt;</span>
<span class="err">合并分支</span>
<span class="err">$</span> <span class="nx">git</span> <span class="nb">merge</span> <span class="o">&lt;</span><span class="nx">commit</span><span class="o">&gt;</span>
<span class="err">$</span> <span class="nx">git</span> <span class="nx">checkout</span> <span class="nx">master</span>
<span class="nx">Switched</span> <span class="k">to</span> <span class="nx">branch</span> <span class="s1">&#39;master&#39;</span>
<span class="err">$</span> <span class="nx">git</span> <span class="nb">merge</span> <span class="nx">dev1</span>
<span class="err">删除分支</span>
<span class="err">$</span> <span class="nx">git</span> <span class="nx">branch</span> <span class="na">-d</span> <span class="o">&lt;</span><span class="nx">branchname</span><span class="o">&gt;</span>
</pre></div>


<h3 id="git-branch">git branch系列操作</h3>
<div class="hlcode"><pre><span class="n">git</span> <span class="n">branch</span>  <span class="c1">//不带参数：查看本地已经存在的分支，并且在当前分支的前面加“*”号标记</span>
<span class="n">git</span> <span class="n">branch</span> <span class="o">-</span><span class="n">r</span> <span class="c1">//列出远程分支</span>
<span class="n">git</span> <span class="n">branch</span> <span class="o">-</span><span class="n">a</span> <span class="c1">//列出本地分支和远程分支</span>
<span class="n">git</span> <span class="n">branch</span> <span class="n">new_branch</span> <span class="c1">//创建一个新的本地分支，需要注意，此处只是创建分支，不进行分支切换</span>
<span class="n">git</span> <span class="n">branch</span> <span class="o">-</span><span class="n">m</span> <span class="o">|</span> <span class="o">-</span><span class="n">M</span> <span class="n">oldbranch</span> <span class="n">newbranch</span> <span class="c1">//重命名分支</span>
<span class="n">git</span> <span class="n">branch</span> <span class="o">-</span><span class="n">d</span> <span class="o">|</span> <span class="o">-</span><span class="n">D</span> <span class="n">branchname</span> <span class="c1">//删除branchname分支</span>
<span class="n">git</span> <span class="n">branch</span> <span class="o">-</span><span class="n">d</span> <span class="o">-</span><span class="n">r</span> <span class="n">branchname</span> <span class="c1">//删除远程branchname分支</span>
</pre></div>


<h3 id="_25">分支合并</h3>
<div class="hlcode"><pre><span class="n">git</span> <span class="n">merge</span> <span class="n">branch_x</span> <span class="c1">//合并指定分支branch_x到当前分支上</span>
</pre></div>


<h3 id="_26">分支策略：</h3>
<div class="hlcode"><pre><span class="mi">1</span><span class="p">)</span><span class="n">master</span><span class="err">主分支应该是非常稳定的，也就是用来发布新版本，一般情况下不允许主分支上干活</span>
<span class="mi">2</span><span class="p">)</span><span class="err">干活一般情况下在新建的</span><span class="n">dev</span><span class="err">分支上干活，干完后，</span><span class="n">dev</span><span class="err">分支代码稳定后可以合并到主分支</span><span class="n">master</span><span class="err">上来。</span>
</pre></div>


<h2 id="_27">其他</h2>
<div class="hlcode"><pre><span class="n">git</span> <span class="n">stash</span>  <span class="c1">//把当前工作现场</span>
<span class="n">git</span> <span class="n">stash</span> <span class="n">list</span>  <span class="c1">//查看stash列表</span>
<span class="n">stash</span><span class="err">回复</span>
<span class="mi">1</span><span class="err">）</span><span class="n">git</span> <span class="n">stash</span> <span class="n">apply</span><span class="err">恢复，恢复后，</span><span class="n">stash</span><span class="err">内容并不删除，你需要使用命令</span><span class="n">git</span> <span class="n">stash</span> <span class="n">drop</span><span class="err">来删除。</span>
<span class="mi">2</span><span class="err">）另一种方式是使用</span><span class="n">git</span> <span class="n">stash</span> <span class="n">pop</span><span class="p">,</span><span class="err">恢复的同时把</span><span class="n">stash</span><span class="err">内容也删除了。</span>
</pre></div>


<p>------------</p>
<blockquote>
<p>文章修改记录<br />
add time 2016-01-27</p>
</blockquote>
    </div>

        </div>
        <div id="footer">
            <span>
                Copyright © 2012-2016 <a href="http://starscount.cn">starscount</a> Powered by <a href="http://simiki.org/" target="_blank">Simiki</a>.Theme by <a href="https://github.com/tankywoo/yasimple" target="_blank">YASimple</a>.
            </span>
        </div>
    </body>
</html>